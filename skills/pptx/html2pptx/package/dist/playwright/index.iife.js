var ExtractSlideData=(function(w){"use strict";const U=["impact"];function a(i){return i/96}function p(i){return parseFloat(String(i))*.75}function b(i){if(i==="rgba(0, 0, 0, 0)"||i==="transparent")return"FFFFFF";const n=i.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);return n?n.slice(1).map(o=>parseInt(o).toString(16).padStart(2,"0")).join(""):"FFFFFF"}function W(i){const n=i.match(/rgba\((\d+),\s*(\d+),\s*(\d+),\s*([\d.]+)\)/);if(!n||!n[4])return null;const o=parseFloat(n[4]);return Math.round((1-o)*100)}function $(i){if(!i)return!1;const n=i.toLowerCase().replace(/['"]/g,"").split(",")[0].trim();return U.includes(n)}function A(i,n){return n==="uppercase"?i.toUpperCase():n==="lowercase"?i.toLowerCase():n==="capitalize"?i.replace(/\b\w/g,o=>o.toUpperCase()):i}function G(i,n){let o=0;if(n==="vertical-rl"?o=90:n==="vertical-lr"&&(o=270),i&&i!=="none"){const y=i.match(/rotate\((-?\d+(?:\.\d+)?)deg\)/);if(y)o+=parseFloat(y[1]);else{const l=i.match(/matrix\(([^)]+)\)/);if(l){const g=l[1].split(",").map(parseFloat),h=Math.atan2(g[1],g[0])*(180/Math.PI);o+=Math.round(h)}}}return o=o%360,o<0&&(o+=360),o===0?null:o}function O(i,n,o){if(o===null)return{x:n.left,y:n.top,w:n.width,h:n.height};if(o===90||o===270){const h=n.left+n.width/2,S=n.top+n.height/2;return{x:h-n.height/2,y:S-n.width/2,w:n.height,h:n.width}}const l=n.left+n.width/2,g=n.top+n.height/2;return{x:l-i.offsetWidth/2,y:g-i.offsetHeight/2,w:i.offsetWidth,h:i.offsetHeight}}function V(i){if(!i||i==="none"||i.match(/inset/))return null;const o=i.match(/rgba?\([^)]+\)/),y=i.match(/([-\d.]+)(px|pt)/g);if(!y||y.length<2)return null;const l=parseFloat(y[0]),g=parseFloat(y[1]),h=y.length>2?parseFloat(y[2]):0;let S=0;(l!==0||g!==0)&&(S=Math.atan2(g,l)*(180/Math.PI),S<0&&(S+=360));const R=Math.sqrt(l*l+g*g)*.75;let s=.5;if(o){const e=o[0].match(/[\d.]+\)$/);e&&(s=parseFloat(e[0].replace(")","")))}return{type:"outer",angle:Math.round(S),blur:h*.75,color:o?b(o[0]):"000000",offset:R,opacity:s}}function H(i,n={},o=[],y=g=>g,l=[]){let g=!1;return i.childNodes.forEach(h=>{let S=y;const R=h.nodeType===Node.TEXT_NODE||h.tagName==="BR";if(R){const s=h.tagName==="BR"?`
`:S(h.textContent.replace(/\s+/g," ")),e=o[o.length-1];g&&e?e.text+=s:o.push({text:s,options:{...n}})}else if(h.nodeType===Node.ELEMENT_NODE&&h.textContent.trim()){const s=h,e={...n},c=window.getComputedStyle(s);if(s.tagName==="SPAN"||s.tagName==="B"||s.tagName==="STRONG"||s.tagName==="I"||s.tagName==="EM"||s.tagName==="U"){if((c.fontWeight==="bold"||parseInt(c.fontWeight)>=600)&&!$(c.fontFamily)&&(e.bold=!0),c.fontStyle==="italic"&&(e.italic=!0),c.color&&c.color!=="rgb(0, 0, 0)"){e.color=b(c.color);const B=W(c.color);B!==null&&(e.transparency=B)}if(c.textDecoration&&c.textDecoration.includes("underline")&&(e.underline={style:"sng",color:b(c.color)}),c.fontSize&&(e.fontSize=p(c.fontSize)),c.textTransform&&c.textTransform!=="none"){const B=c.textTransform;S=d=>A(d,B)}c.marginLeft&&parseFloat(c.marginLeft)>0&&l.push(`Inline element <${s.tagName.toLowerCase()}> has margin-left which is not supported in PowerPoint. Remove margin from inline elements.`),c.marginRight&&parseFloat(c.marginRight)>0&&l.push(`Inline element <${s.tagName.toLowerCase()}> has margin-right which is not supported in PowerPoint. Remove margin from inline elements.`),c.marginTop&&parseFloat(c.marginTop)>0&&l.push(`Inline element <${s.tagName.toLowerCase()}> has margin-top which is not supported in PowerPoint. Remove margin from inline elements.`),c.marginBottom&&parseFloat(c.marginBottom)>0&&l.push(`Inline element <${s.tagName.toLowerCase()}> has margin-bottom which is not supported in PowerPoint. Remove margin from inline elements.`),H(s,e,o,S,l)}}g=R}),o.length>0&&(o[0].text=o[0].text.replace(/^\s+/,""),o[o.length-1].text=o[o.length-1].text.replace(/\s+$/,"")),o.filter(h=>h.text.length>0)}function Z(){const i=document.body,n=window.getComputedStyle(i),o=n.backgroundImage,y=n.backgroundColor,l=[];o&&(o.includes("linear-gradient")||o.includes("radial-gradient"))&&l.push("CSS gradients are not supported. Use Sharp to rasterize gradients as PNG images first, then reference with background-image: url('gradient.png')");let g;if(o&&o!=="none"){const e=o.match(/url\(["']?([^"')]+)["']?\)/);e?g={type:"image",path:e[1]}:g={type:"color",value:b(y)}}else g={type:"color",value:b(y)};const h=[],S=[],R=["P","H1","H2","H3","H4","H5","H6","UL","OL","LI"],s=new Set;return document.querySelectorAll("*").forEach(e=>{if(s.has(e))return;if(R.includes(e.tagName)){const t=window.getComputedStyle(e),f=t.backgroundColor&&t.backgroundColor!=="rgba(0, 0, 0, 0)",u=t.borderWidth&&parseFloat(t.borderWidth)>0||t.borderTopWidth&&parseFloat(t.borderTopWidth)>0||t.borderRightWidth&&parseFloat(t.borderRightWidth)>0||t.borderBottomWidth&&parseFloat(t.borderBottomWidth)>0||t.borderLeftWidth&&parseFloat(t.borderLeftWidth)>0,T=t.boxShadow&&t.boxShadow!=="none";if(f||u||T){l.push(`Text element <${e.tagName.toLowerCase()}> has ${f?"background":u?"border":"shadow"}. Backgrounds, borders, and shadows are only supported on <div> elements, not text elements.`);return}}if(e.className&&e.className.includes("placeholder")){const t=e.getBoundingClientRect();t.width===0||t.height===0?l.push(`Placeholder "${e.id||"unnamed"}" has ${t.width===0?"width: 0":"height: 0"}. Check the layout CSS.`):S.push({id:e.id||`placeholder-${S.length}`,x:a(t.left),y:a(t.top),w:a(t.width),h:a(t.height)}),s.add(e);return}if(e.tagName==="IMG"){const t=e.getBoundingClientRect();if(t.width>0&&t.height>0){h.push({type:"image",src:e.src,position:{x:a(t.left),y:a(t.top),w:a(t.width),h:a(t.height)}}),s.add(e);return}}if(e.tagName==="DIV"&&!R.includes(e.tagName)){const t=window.getComputedStyle(e),f=t.backgroundColor&&t.backgroundColor!=="rgba(0, 0, 0, 0)";for(const r of Array.from(e.childNodes))if(r.nodeType===Node.TEXT_NODE){const m=r.textContent?.trim()||"";m&&l.push(`DIV element contains unwrapped text "${m.substring(0,50)}${m.length>50?"...":""}". All text must be wrapped in <p>, <h1>-<h6>, <ul>, or <ol> tags to appear in PowerPoint.`)}const u=t.backgroundImage;if(u&&u!=="none"){l.push("Background images on DIV elements are not supported. Use solid colors or borders for shapes, or use slide.addImage() in PptxGenJS to layer images.");return}const T=t.borderTopWidth,C=t.borderRightWidth,M=t.borderBottomWidth,k=t.borderLeftWidth,x=[T,C,M,k].map(r=>parseFloat(r)||0),E=x.some(r=>r>0),z=E&&x.every(r=>r===x[0]),_=[];if(E&&!z){const r=e.getBoundingClientRect(),m=a(r.left),N=a(r.top),L=a(r.width),I=a(r.height);if(parseFloat(T)>0){const P=p(T),F=P/72/2;_.push({type:"line",x1:m,y1:N+F,x2:m+L,y2:N+F,width:P,color:b(t.borderTopColor)})}if(parseFloat(C)>0){const P=p(C),F=P/72/2;_.push({type:"line",x1:m+L-F,y1:N,x2:m+L-F,y2:N+I,width:P,color:b(t.borderRightColor)})}if(parseFloat(M)>0){const P=p(M),F=P/72/2;_.push({type:"line",x1:m,y1:N+I-F,x2:m+L,y2:N+I-F,width:P,color:b(t.borderBottomColor)})}if(parseFloat(k)>0){const P=p(k),F=P/72/2;_.push({type:"line",x1:m+F,y1:N,x2:m+F,y2:N+I,width:P,color:b(t.borderLeftColor)})}}if(f||E){const r=e.getBoundingClientRect();if(r.width>0&&r.height>0){const m=V(t.boxShadow),N=m?{...m,type:"outer"}:null;(f||z)&&h.push({type:"shape",text:"",position:{x:a(r.left),y:a(r.top),w:a(r.width),h:a(r.height)},shape:{fill:f?b(t.backgroundColor):null,transparency:f?W(t.backgroundColor):null,line:z?{color:b(t.borderColor),width:p(t.borderWidth)}:null,rectRadius:(()=>{const L=t.borderRadius,I=parseFloat(L);if(I===0)return 0;if(L.includes("%")){if(I>=50)return 1;const P=Math.min(r.width,r.height);return I/100*a(P)}return L.includes("pt")?I/72:I/96})(),shadow:N}}),h.push(..._),s.add(e);return}}}if(e.tagName==="UL"||e.tagName==="OL"){const t=e.getBoundingClientRect();if(t.width===0||t.height===0)return;const f=Array.from(e.querySelectorAll("li")),u=[],T=window.getComputedStyle(e),C=p(T.paddingLeft),M=C*.5,k=C*.5;f.forEach((E,z)=>{const _=z===f.length-1,r=H(E,{breakLine:!1},[],m=>m,l);r.length>0&&(r[0].text=r[0].text.replace(/^[•\-*▪▸]\s*/,""),r[0].options.bullet={indent:k}),r.length>0&&!_&&(r[r.length-1].options.breakLine=!0),u.push(...r)});const x=window.getComputedStyle(f[0]||e);h.push({type:"list",items:u,position:{x:a(t.left),y:a(t.top),w:a(t.width),h:a(t.height)},style:{fontSize:p(x.fontSize),fontFace:x.fontFamily.split(",")[0].replace(/['"]/g,"").trim(),color:b(x.color),transparency:W(x.color),align:x.textAlign==="start"?"left":x.textAlign,lineSpacing:x.lineHeight&&x.lineHeight!=="normal"?p(x.lineHeight):null,paraSpaceBefore:0,paraSpaceAfter:p(x.marginBottom),margin:[M,0,0,0]}}),f.forEach(E=>s.add(E)),s.add(e);return}if(!R.includes(e.tagName))return;const v=e.getBoundingClientRect(),B=e.textContent.trim();if(v.width===0||v.height===0||!B)return;if(e.tagName!=="LI"&&/^[•\-*▪▸○●◆◇■□]\s/.test(B.trimStart())){l.push(`Text element <${e.tagName.toLowerCase()}> starts with bullet symbol "${B.substring(0,20)}...". Use <ul> or <ol> lists instead of manual bullet symbols.`);return}const d=window.getComputedStyle(e),D=G(d.transform,d.writingMode),{x:q,y:j,w:Y,h:J}=O(e,v,D),X={fontSize:p(d.fontSize),fontFace:d.fontFamily.split(",")[0].replace(/['"]/g,"").trim(),color:b(d.color),align:d.textAlign==="start"?"left":d.textAlign,lineSpacing:p(d.lineHeight),paraSpaceBefore:p(d.marginTop),paraSpaceAfter:p(d.marginBottom),margin:[p(d.paddingLeft),p(d.paddingRight),p(d.paddingBottom),p(d.paddingTop)]},K=W(d.color);K!==null&&(X.transparency=K),D!==null&&(X.rotate=D);const tt=e.querySelector("b, i, u, strong, em, span, br"),Q=e.tagName.toLowerCase();if(tt){const t=d.textTransform,f=H(e,{},[],T=>A(T,t),l),u={...X};if(u.lineSpacing&&typeof u.fontSize=="number"){const T=Math.max(u.fontSize,...f.map(C=>typeof C.options?.fontSize=="number"?C.options.fontSize:0));if(T>u.fontSize){const C=u.lineSpacing/u.fontSize;u.lineSpacing=T*C}}h.push({type:Q,text:f,position:{x:a(q),y:a(j),w:a(Y),h:a(J)},style:u})}else{const t=d.textTransform,f=A(B,t),u=d.fontWeight==="bold"||parseInt(d.fontWeight)>=600;h.push({type:Q,text:f,position:{x:a(q),y:a(j),w:a(Y),h:a(J)},style:{...X,bold:u&&!$(d.fontFamily),italic:d.fontStyle==="italic",underline:d.textDecoration.includes("underline")}})}s.add(e)}),{background:g,elements:h,placeholders:S,errors:l}}return w.PT_PER_PX=.75,w.PX_PER_IN=96,w.SINGLE_WEIGHT_FONTS=U,w.applyTextTransform=A,w.extractAlpha=W,w.extractSlideDataInBrowser=Z,w.getPositionAndSize=O,w.getRotation=G,w.parseBoxShadow=V,w.parseInlineFormatting=H,w.pxToInch=a,w.pxToPoints=p,w.rgbToHex=b,w.shouldSkipBold=$,Object.defineProperty(w,Symbol.toStringTag,{value:"Module"}),w})({});
//# sourceMappingURL=index.iife.js.map
